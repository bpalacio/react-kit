"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var s=require("./errors.js"),t=require("./impl/formatter.js"),e=require("./impl/invalid.js"),i=require("./impl/locale.js"),r=require("./impl/regexParser.js"),n=require("./impl/util.js"),o=require("./settings.js");const a={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},l={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...a},u=365.2425,c=30.436875,h={years:{quarters:4,months:12,weeks:52.1775,days:u,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:4.3481250000000005,days:c,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3},...a},m=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],d=m.slice(0).reverse();function f(s,t,e=!1){const i={values:e?t.values:{...s.values,...t.values||{}},loc:s.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||s.conversionAccuracy,matrix:t.matrix||s.matrix};return new y(i)}function v(s,t,e,i,r){const n=s[r][e],o=t[e]/n,a=!(Math.sign(o)===Math.sign(i[r]))&&0!==i[r]&&Math.abs(o)<=1?(l=o)<0?Math.floor(l):Math.ceil(l):Math.trunc(o);var l;i[r]+=a,t[e]-=a*n}class y{constructor(s){const t="longterm"===s.conversionAccuracy||!1;let e=t?h:l;s.matrix&&(e=s.matrix),this.values=s.values,this.loc=s.loc||i.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=s.invalid||null,this.matrix=e,this.isLuxonDuration=!0}static fromMillis(s,t){return y.fromObject({milliseconds:s},t)}static fromObject(t,e={}){if(null==t||"object"!=typeof t)throw new s.InvalidArgumentError("Duration.fromObject: argument expected to be an object, got "+(null===t?"null":typeof t));return new y({values:n.normalizeObject(t,y.normalizeUnit),loc:i.fromObject(e),conversionAccuracy:e.conversionAccuracy,matrix:e.matrix})}static fromDurationLike(t){if(n.isNumber(t))return y.fromMillis(t);if(y.isDuration(t))return t;if("object"==typeof t)return y.fromObject(t);throw new s.InvalidArgumentError(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(s,t){const[e]=r.parseISODuration(s);return e?y.fromObject(e,t):y.invalid("unparsable",`the input "${s}" can't be parsed as ISO 8601`)}static fromISOTime(s,t){const[e]=r.parseISOTimeOnly(s);return e?y.fromObject(e,t):y.invalid("unparsable",`the input "${s}" can't be parsed as ISO 8601`)}static invalid(t,i=null){if(!t)throw new s.InvalidArgumentError("need to specify a reason the Duration is invalid");const r=t instanceof e?t:new e(t,i);if(o.throwOnInvalid)throw new s.InvalidDurationError(r);return new y({invalid:r})}static normalizeUnit(t){const e={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t?t.toLowerCase():t];if(!e)throw new s.InvalidUnitError(t);return e}static isDuration(s){return s&&s.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(s,e={}){const i={...e,floor:!1!==e.round&&!1!==e.floor};return this.isValid?t.create(this.loc,i).formatDurationFromString(this,s):"Invalid Duration"}toHuman(s={}){const t=m.map((t=>{const e=this.values[t];return n.isUndefined(e)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...s,unit:t.slice(0,-1)}).format(e)})).filter((s=>s));return this.loc.listFormatter({type:"conjunction",style:s.listStyle||"narrow",...s}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let s="P";return 0!==this.years&&(s+=this.years+"Y"),0===this.months&&0===this.quarters||(s+=this.months+3*this.quarters+"M"),0!==this.weeks&&(s+=this.weeks+"W"),0!==this.days&&(s+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(s+="T"),0!==this.hours&&(s+=this.hours+"H"),0!==this.minutes&&(s+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(s+=n.roundTo(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===s&&(s+="T0S"),s}toISOTime(s={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;s={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...s};const e=this.shiftTo("hours","minutes","seconds","milliseconds");let i="basic"===s.format?"hhmm":"hh:mm";s.suppressSeconds&&0===e.seconds&&0===e.milliseconds||(i+="basic"===s.format?"ss":":ss",s.suppressMilliseconds&&0===e.milliseconds||(i+=".SSS"));let r=e.toFormat(i);return s.includePrefix&&(r="T"+r),r}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(s){if(!this.isValid)return this;const t=y.fromDurationLike(s),e={};for(const s of m)(n.hasOwnProperty(t.values,s)||n.hasOwnProperty(this.values,s))&&(e[s]=t.get(s)+this.get(s));return f(this,{values:e},!0)}minus(s){if(!this.isValid)return this;const t=y.fromDurationLike(s);return this.plus(t.negate())}mapUnits(s){if(!this.isValid)return this;const t={};for(const e of Object.keys(this.values))t[e]=n.asNumber(s(this.values[e],e));return f(this,{values:t},!0)}get(s){return this[y.normalizeUnit(s)]}set(s){if(!this.isValid)return this;return f(this,{values:{...this.values,...n.normalizeObject(s,y.normalizeUnit)}})}reconfigure({locale:s,numberingSystem:t,conversionAccuracy:e,matrix:i}={}){return f(this,{loc:this.loc.clone({locale:s,numberingSystem:t}),matrix:i,conversionAccuracy:e})}as(s){return this.isValid?this.shiftTo(s).get(s):NaN}normalize(){if(!this.isValid)return this;const s=this.toObject();return function(s,t){d.reduce(((e,i)=>n.isUndefined(t[i])?e:(e&&v(s,t,e,t,i),i)),null)}(this.matrix,s),f(this,{values:s},!0)}rescale(){if(!this.isValid)return this;return f(this,{values:function(s){const t={};for(const[e,i]of Object.entries(s))0!==i&&(t[e]=i);return t}(this.normalize().shiftToAll().toObject())},!0)}shiftTo(...s){if(!this.isValid)return this;if(0===s.length)return this;s=s.map((s=>y.normalizeUnit(s)));const t={},e={},i=this.toObject();let r;for(const o of m)if(s.indexOf(o)>=0){r=o;let s=0;for(const t in e)s+=this.matrix[t][o]*e[t],e[t]=0;n.isNumber(i[o])&&(s+=i[o]);const a=Math.trunc(s);t[o]=a,e[o]=(1e3*s-1e3*a)/1e3;for(const s in i)m.indexOf(s)>m.indexOf(o)&&v(this.matrix,i,s,t,o)}else n.isNumber(i[o])&&(e[o]=i[o]);for(const s in e)0!==e[s]&&(t[r]+=s===r?e[s]:e[s]/this.matrix[r][s]);return f(this,{values:t},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const s={};for(const t of Object.keys(this.values))s[t]=0===this.values[t]?0:-this.values[t];return f(this,{values:s},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(s){if(!this.isValid||!s.isValid)return!1;if(!this.loc.equals(s.loc))return!1;for(const i of m)if(t=this.values[i],e=s.values[i],!(void 0===t||0===t?void 0===e||0===e:t===e))return!1;var t,e;return!0}}exports.accurateMatrix=h,exports.casualMatrix=l,exports.daysInMonthAccurate=c,exports.daysInYearAccurate=u,exports.default=y,exports.lowOrderMatrix=a;
//# sourceMappingURL=duration.js.map
