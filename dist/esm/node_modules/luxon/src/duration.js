import{InvalidArgumentError as s,InvalidDurationError as t,InvalidUnitError as i}from"./errors.js";import e from"./impl/formatter.js";import n from"./impl/invalid.js";import r from"./impl/locale.js";import{parseISODuration as o,parseISOTimeOnly as l}from"./impl/regexParser.js";import{normalizeObject as a,isNumber as u,isUndefined as c,roundTo as h,hasOwnProperty as m,asNumber as d}from"./impl/util.js";import f from"./settings.js";const v={weeks:{days:7,hours:168,minutes:10080,seconds:604800,milliseconds:6048e5},days:{hours:24,minutes:1440,seconds:86400,milliseconds:864e5},hours:{minutes:60,seconds:3600,milliseconds:36e5},minutes:{seconds:60,milliseconds:6e4},seconds:{milliseconds:1e3}},y={years:{quarters:4,months:12,weeks:52,days:365,hours:8760,minutes:525600,seconds:31536e3,milliseconds:31536e6},quarters:{months:3,weeks:13,days:91,hours:2184,minutes:131040,seconds:7862400,milliseconds:78624e5},months:{weeks:4,days:30,hours:720,minutes:43200,seconds:2592e3,milliseconds:2592e6},...v},p=365.2425,g=30.436875,w={years:{quarters:4,months:12,weeks:52.1775,days:p,hours:8765.82,minutes:525949.2,seconds:525949.2*60,milliseconds:525949.2*60*1e3},quarters:{months:3,weeks:13.044375,days:91.310625,hours:2191.455,minutes:131487.3,seconds:525949.2*60/4,milliseconds:7889237999.999999},months:{weeks:4.3481250000000005,days:g,hours:730.485,minutes:43829.1,seconds:2629746,milliseconds:2629746e3},...v},b=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],O=b.slice(0).reverse();function V(s,t,i=!1){const e={values:i?t.values:{...s.values,...t.values||{}},loc:s.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||s.conversionAccuracy,matrix:t.matrix||s.matrix};return new j(e)}function x(s,t,i,e,n){const r=s[n][i],o=t[i]/r,l=!(Math.sign(o)===Math.sign(e[n]))&&0!==e[n]&&Math.abs(o)<=1?(a=o)<0?Math.floor(a):Math.ceil(a):Math.trunc(o);var a;e[n]+=l,t[i]-=l*r}class j{constructor(s){const t="longterm"===s.conversionAccuracy||!1;let i=t?w:y;s.matrix&&(i=s.matrix),this.values=s.values,this.loc=s.loc||r.create(),this.conversionAccuracy=t?"longterm":"casual",this.invalid=s.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(s,t){return j.fromObject({milliseconds:s},t)}static fromObject(t,i={}){if(null==t||"object"!=typeof t)throw new s("Duration.fromObject: argument expected to be an object, got "+(null===t?"null":typeof t));return new j({values:a(t,j.normalizeUnit),loc:r.fromObject(i),conversionAccuracy:i.conversionAccuracy,matrix:i.matrix})}static fromDurationLike(t){if(u(t))return j.fromMillis(t);if(j.isDuration(t))return t;if("object"==typeof t)return j.fromObject(t);throw new s(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(s,t){const[i]=o(s);return i?j.fromObject(i,t):j.invalid("unparsable",`the input "${s}" can't be parsed as ISO 8601`)}static fromISOTime(s,t){const[i]=l(s);return i?j.fromObject(i,t):j.invalid("unparsable",`the input "${s}" can't be parsed as ISO 8601`)}static invalid(i,e=null){if(!i)throw new s("need to specify a reason the Duration is invalid");const r=i instanceof n?i:new n(i,e);if(f.throwOnInvalid)throw new t(r);return new j({invalid:r})}static normalizeUnit(s){const t={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[s?s.toLowerCase():s];if(!t)throw new i(s);return t}static isDuration(s){return s&&s.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(s,t={}){const i={...t,floor:!1!==t.round&&!1!==t.floor};return this.isValid?e.create(this.loc,i).formatDurationFromString(this,s):"Invalid Duration"}toHuman(s={}){const t=b.map((t=>{const i=this.values[t];return c(i)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...s,unit:t.slice(0,-1)}).format(i)})).filter((s=>s));return this.loc.listFormatter({type:"conjunction",style:s.listStyle||"narrow",...s}).format(t)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let s="P";return 0!==this.years&&(s+=this.years+"Y"),0===this.months&&0===this.quarters||(s+=this.months+3*this.quarters+"M"),0!==this.weeks&&(s+=this.weeks+"W"),0!==this.days&&(s+=this.days+"D"),0===this.hours&&0===this.minutes&&0===this.seconds&&0===this.milliseconds||(s+="T"),0!==this.hours&&(s+=this.hours+"H"),0!==this.minutes&&(s+=this.minutes+"M"),0===this.seconds&&0===this.milliseconds||(s+=h(this.seconds+this.milliseconds/1e3,3)+"S"),"P"===s&&(s+="T0S"),s}toISOTime(s={}){if(!this.isValid)return null;const t=this.toMillis();if(t<0||t>=864e5)return null;s={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...s};const i=this.shiftTo("hours","minutes","seconds","milliseconds");let e="basic"===s.format?"hhmm":"hh:mm";s.suppressSeconds&&0===i.seconds&&0===i.milliseconds||(e+="basic"===s.format?"ss":":ss",s.suppressMilliseconds&&0===i.milliseconds||(e+=".SSS"));let n=i.toFormat(e);return s.includePrefix&&(n="T"+n),n}toJSON(){return this.toISO()}toString(){return this.toISO()}toMillis(){return this.as("milliseconds")}valueOf(){return this.toMillis()}plus(s){if(!this.isValid)return this;const t=j.fromDurationLike(s),i={};for(const s of b)(m(t.values,s)||m(this.values,s))&&(i[s]=t.get(s)+this.get(s));return V(this,{values:i},!0)}minus(s){if(!this.isValid)return this;const t=j.fromDurationLike(s);return this.plus(t.negate())}mapUnits(s){if(!this.isValid)return this;const t={};for(const i of Object.keys(this.values))t[i]=d(s(this.values[i],i));return V(this,{values:t},!0)}get(s){return this[j.normalizeUnit(s)]}set(s){if(!this.isValid)return this;return V(this,{values:{...this.values,...a(s,j.normalizeUnit)}})}reconfigure({locale:s,numberingSystem:t,conversionAccuracy:i,matrix:e}={}){return V(this,{loc:this.loc.clone({locale:s,numberingSystem:t}),matrix:e,conversionAccuracy:i})}as(s){return this.isValid?this.shiftTo(s).get(s):NaN}normalize(){if(!this.isValid)return this;const s=this.toObject();return function(s,t){O.reduce(((i,e)=>c(t[e])?i:(i&&x(s,t,i,t,e),e)),null)}(this.matrix,s),V(this,{values:s},!0)}rescale(){if(!this.isValid)return this;return V(this,{values:function(s){const t={};for(const[i,e]of Object.entries(s))0!==e&&(t[i]=e);return t}(this.normalize().shiftToAll().toObject())},!0)}shiftTo(...s){if(!this.isValid)return this;if(0===s.length)return this;s=s.map((s=>j.normalizeUnit(s)));const t={},i={},e=this.toObject();let n;for(const r of b)if(s.indexOf(r)>=0){n=r;let s=0;for(const t in i)s+=this.matrix[t][r]*i[t],i[t]=0;u(e[r])&&(s+=e[r]);const o=Math.trunc(s);t[r]=o,i[r]=(1e3*s-1e3*o)/1e3;for(const s in e)b.indexOf(s)>b.indexOf(r)&&x(this.matrix,e,s,t,r)}else u(e[r])&&(i[r]=e[r]);for(const s in i)0!==i[s]&&(t[n]+=s===n?i[s]:i[s]/this.matrix[n][s]);return V(this,{values:t},!0).normalize()}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const s={};for(const t of Object.keys(this.values))s[t]=0===this.values[t]?0:-this.values[t];return V(this,{values:s},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return null===this.invalid}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(s){if(!this.isValid||!s.isValid)return!1;if(!this.loc.equals(s.loc))return!1;for(const e of b)if(t=this.values[e],i=s.values[e],!(void 0===t||0===t?void 0===i||0===i:t===i))return!1;var t,i;return!0}}export{w as accurateMatrix,y as casualMatrix,g as daysInMonthAccurate,p as daysInYearAccurate,j as default,v as lowOrderMatrix};
//# sourceMappingURL=duration.js.map
