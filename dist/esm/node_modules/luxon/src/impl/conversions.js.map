{"version":3,"file":"conversions.js","sources":["../../../../../../node_modules/luxon/src/impl/conversions.js"],"sourcesContent":["import {\n  integerBetween,\n  isLeapYear,\n  timeObject,\n  daysInYear,\n  daysInMonth,\n  weeksInWeekYear,\n  isInteger,\n} from \"./util.js\";\nimport Invalid from \"./invalid.js\";\n\nconst nonLeapLadder = [0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334],\n  leapLadder = [0, 31, 60, 91, 121, 152, 182, 213, 244, 274, 305, 335];\n\nfunction unitOutOfRange(unit, value) {\n  return new Invalid(\n    \"unit out of range\",\n    `you specified ${value} (of type ${typeof value}) as a ${unit}, which is invalid`\n  );\n}\n\nfunction dayOfWeek(year, month, day) {\n  const d = new Date(Date.UTC(year, month - 1, day));\n\n  if (year < 100 && year >= 0) {\n    d.setUTCFullYear(d.getUTCFullYear() - 1900);\n  }\n\n  const js = d.getUTCDay();\n\n  return js === 0 ? 7 : js;\n}\n\nfunction computeOrdinal(year, month, day) {\n  return day + (isLeapYear(year) ? leapLadder : nonLeapLadder)[month - 1];\n}\n\nfunction uncomputeOrdinal(year, ordinal) {\n  const table = isLeapYear(year) ? leapLadder : nonLeapLadder,\n    month0 = table.findIndex((i) => i < ordinal),\n    day = ordinal - table[month0];\n  return { month: month0 + 1, day };\n}\n\n/**\n * @private\n */\n\nexport function gregorianToWeek(gregObj) {\n  const { year, month, day } = gregObj,\n    ordinal = computeOrdinal(year, month, day),\n    weekday = dayOfWeek(year, month, day);\n\n  let weekNumber = Math.floor((ordinal - weekday + 10) / 7),\n    weekYear;\n\n  if (weekNumber < 1) {\n    weekYear = year - 1;\n    weekNumber = weeksInWeekYear(weekYear);\n  } else if (weekNumber > weeksInWeekYear(year)) {\n    weekYear = year + 1;\n    weekNumber = 1;\n  } else {\n    weekYear = year;\n  }\n\n  return { weekYear, weekNumber, weekday, ...timeObject(gregObj) };\n}\n\nexport function weekToGregorian(weekData) {\n  const { weekYear, weekNumber, weekday } = weekData,\n    weekdayOfJan4 = dayOfWeek(weekYear, 1, 4),\n    yearInDays = daysInYear(weekYear);\n\n  let ordinal = weekNumber * 7 + weekday - weekdayOfJan4 - 3,\n    year;\n\n  if (ordinal < 1) {\n    year = weekYear - 1;\n    ordinal += daysInYear(year);\n  } else if (ordinal > yearInDays) {\n    year = weekYear + 1;\n    ordinal -= daysInYear(weekYear);\n  } else {\n    year = weekYear;\n  }\n\n  const { month, day } = uncomputeOrdinal(year, ordinal);\n  return { year, month, day, ...timeObject(weekData) };\n}\n\nexport function gregorianToOrdinal(gregData) {\n  const { year, month, day } = gregData;\n  const ordinal = computeOrdinal(year, month, day);\n  return { year, ordinal, ...timeObject(gregData) };\n}\n\nexport function ordinalToGregorian(ordinalData) {\n  const { year, ordinal } = ordinalData;\n  const { month, day } = uncomputeOrdinal(year, ordinal);\n  return { year, month, day, ...timeObject(ordinalData) };\n}\n\nexport function hasInvalidWeekData(obj) {\n  const validYear = isInteger(obj.weekYear),\n    validWeek = integerBetween(obj.weekNumber, 1, weeksInWeekYear(obj.weekYear)),\n    validWeekday = integerBetween(obj.weekday, 1, 7);\n\n  if (!validYear) {\n    return unitOutOfRange(\"weekYear\", obj.weekYear);\n  } else if (!validWeek) {\n    return unitOutOfRange(\"week\", obj.week);\n  } else if (!validWeekday) {\n    return unitOutOfRange(\"weekday\", obj.weekday);\n  } else return false;\n}\n\nexport function hasInvalidOrdinalData(obj) {\n  const validYear = isInteger(obj.year),\n    validOrdinal = integerBetween(obj.ordinal, 1, daysInYear(obj.year));\n\n  if (!validYear) {\n    return unitOutOfRange(\"year\", obj.year);\n  } else if (!validOrdinal) {\n    return unitOutOfRange(\"ordinal\", obj.ordinal);\n  } else return false;\n}\n\nexport function hasInvalidGregorianData(obj) {\n  const validYear = isInteger(obj.year),\n    validMonth = integerBetween(obj.month, 1, 12),\n    validDay = integerBetween(obj.day, 1, daysInMonth(obj.year, obj.month));\n\n  if (!validYear) {\n    return unitOutOfRange(\"year\", obj.year);\n  } else if (!validMonth) {\n    return unitOutOfRange(\"month\", obj.month);\n  } else if (!validDay) {\n    return unitOutOfRange(\"day\", obj.day);\n  } else return false;\n}\n\nexport function hasInvalidTimeData(obj) {\n  const { hour, minute, second, millisecond } = obj;\n  const validHour =\n      integerBetween(hour, 0, 23) ||\n      (hour === 24 && minute === 0 && second === 0 && millisecond === 0),\n    validMinute = integerBetween(minute, 0, 59),\n    validSecond = integerBetween(second, 0, 59),\n    validMillisecond = integerBetween(millisecond, 0, 999);\n\n  if (!validHour) {\n    return unitOutOfRange(\"hour\", hour);\n  } else if (!validMinute) {\n    return unitOutOfRange(\"minute\", minute);\n  } else if (!validSecond) {\n    return unitOutOfRange(\"second\", second);\n  } else if (!validMillisecond) {\n    return unitOutOfRange(\"millisecond\", millisecond);\n  } else return false;\n}\n"],"names":["nonLeapLadder","leapLadder","unitOutOfRange","unit","value","Invalid","dayOfWeek","year","month","day","d","Date","UTC","setUTCFullYear","getUTCFullYear","js","getUTCDay","computeOrdinal","isLeapYear","uncomputeOrdinal","ordinal","table","month0","findIndex","i","gregorianToWeek","gregObj","weekday","weekYear","weekNumber","Math","floor","weeksInWeekYear","timeObject","weekToGregorian","weekData","weekdayOfJan4","yearInDays","daysInYear","gregorianToOrdinal","gregData","ordinalToGregorian","ordinalData","hasInvalidWeekData","obj","validYear","isInteger","validWeek","integerBetween","validWeekday","week","hasInvalidOrdinalData","validOrdinal","hasInvalidGregorianData","validMonth","validDay","daysInMonth","hasInvalidTimeData","hour","minute","second","millisecond","validHour","validMinute","validSecond","validMillisecond"],"mappings":"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"}